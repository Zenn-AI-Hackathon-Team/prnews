# 要件定義書

> 参考
https://g.co/gemini/share/7b0eeaa6326c
> 

## 1. プロジェクト概要

### 1.1. 目的

オープンソースソフトウェア（OSS）のリポジトリにおけるプルリクエスト（PR）の内容をAIが解析し、解説記事形式で文章化することで、ユーザーがOSSの動向や技術的な変更点を容易に理解できるようにする。また、「今日のイチオシコミット」のような形で興味深いPRを発見できる機能を提供する。

### 1.2. 背景

最新技術のキャッチアップ、自己学習、技術トレンドの把握を効率的に行うためのツールとして、OSSのPR情報を活用する。

### 1.3. 基本的な動作フロー

- ユーザーが関心のあるPRのタイトル（またはそれに類するUI要素）をクリックする。
- AIエンジン（Gemma、ユーザーローカル環境での実行を想定）がPR情報を解析・要約する。
- 要約結果をデータベースに保存する。

## 2. 機能要件

### 2.1. 認証・認可

- [ ]  **ユーザー認証の実装**
    - [ ]  **GitHub OAuthによるサインイン機能**
        - Firebase Authenticationを利用し、GitHubアカウントでのユーザー登録・ログインを実現する。
    - [ ]  **ユーザー情報の保存**
        - Firebaseのデータベースに以下のGitHubユーザー情報を保存する。
            - GitHubユーザーID
            - GitHubユーザー名 (例: `octocat`)
            - GitHub表示名 (例: `The Octocat`)
            - メールアドレス
            - プロフィール画像のURL
    - [ ]  **ユーザー情報の同期**
        - ユーザーのサムネイル画像・ユーザー名はGitHubの情報を表示し、アプリ側での変更は不可とする。
    - [ ]  **認証エラー時の表示**
        - GitHub認証失敗時には、「GitHubとの連携に失敗しました。」というメッセージを表示する。
    - [ ]  **ログイン状態の管理**
        - ユーザーが明示的にログアウトするまでログイン状態を維持する。
        - 現時点では、特定の操作時における追加の認証（二段階認証など）は考慮しない。
    - [ ]  **ログアウト機能**
        - ログアウトボタンを設置する。
        - ログアウト時には「ログアウトしました」というメッセージを3秒間表示後、ホーム画面（未ログイン状態のトップページ等）に遷移する。

### 2.2. お気に入りライブラリ追加機能

- [ ]  **お気に入りライブラリの登録機能**
    - [ ]  **ライブラリの追加方法**
        - [ ]  GitHubリポジトリのURLを直接入力して追加する。
        - [ ]  (余裕があれば)ライブラリ名やキーワードで検索して追加する。
            - 検索結果には、リポジトリ名、オーナー名、スター数、最終更新日を表示する。
        - [ ]  (余裕があれば) トレンドのライブラリ一覧など、推薦リストからの追加。
    - [ ]  **登録上限数**
        - お気に入りライブラリの登録数に上限は設けない。
- [ ]  **お気に入りライブラリの管理**
    - [ ]  **お気に入り一覧の表示**
        - 一覧には、ライブラリ名、オーナー名、最終更新日、未読のプルリクエスト数を表示する。
    - [ ]  **ライブラリの削除機能**
        - [ ]  削除時の確認メッセージ（例：「本当に削除しますか？」）は表示

### 2.3. プルリクエストの内容を要約

- [ ]  **要約処理の実行**
    - ユーザーがPRタイトル（またはそれに類するUI要素）をクリックした際に、Gemma（ローカル実行想定）を用いて要約処理を実行し、結果をデータベースに保存する。
    - 速度や精度については、ローカル実行を前提として一旦考慮外とする。
- [ ]  **要約に使用する情報源**
    - [ ]  **変更ファイル (File changed) の情報**
        - リポジトリのコード全体と、プルリクエストにおける差分情報 (diff) をAIに渡す。
    - [ ]  **コメント欄 (Conversation) の情報**
        - PR作成者による最初の説明文を特に重要視する。
        - レビューコメント、それに対する回答、議論の経緯、マージ直前のコメントなど、Conversation全体をAIに読ませる。
    - [ ]  **リポジトリのREADMEファイル (および関連ドキュメント) の情報**
        - リポジトリの全体像や目的を把握する。
        - アプリケーションのアーキテクチャや設計思想に関する情報も可能な範囲で読み取らせる (README以外のドキュメントも含む可能性あり)。
    - [ ]  **コードベース全体の知識活用**
        - 将来的には、リポジトリ全体のコードの意味をAIに理解させ、PRによる変更が他の部分にどのような影響を与えるかまで分析させることを目指す。
- [ ]  **要約結果（解説記事）の構成要素**
    - [ ]  **PRの概要タイトル**
        - 解説記事のサムネイル等で使用する、PR内容を表す1～2行程度のタイトル的な文章をAIが生成する（GitHubのPRタイトルそのものではない）。
    - [ ]  **PRの背景・目的**
        - PRのConversation（特にPR作成者の最初の説明文）から、該当箇所をAIが要約・抜粋して説明する。
    - [ ]  **主な変更点 (箇条書き)**
        - 変更されたファイル名
        - ファイル毎の変更の種類（例: 機能追加、バグ修正、リファクタリング）
        - 具体的な変更内容の短い説明
    - [ ]  **注目ポイント・重要な変更点**
        - [ ]  「技術的に面白い、トリッキーなコード」の観点からの指摘。
            - [ ]  バグ修正のアプローチや考え方に関する解説。
            - [ ]  パフォーマンス改善のテクニックに関する指摘。
            - [ ]  新しいライブラリや技術の採用に関する紹介。
        - [ ]  「影響範囲が広い、アーキテクチャに関わる変更」の観点からの指摘。
            - [ ]  アルゴリズムの変更・適用に関する解説。
            - [ ]  デザインパターンの活用に関する解説。

### 2.4. いいね機能

- [ ]  **「いいね！」対象**
    - プルリクエストそのもの（本アプリ内での評価として）。
- [ ]  **「いいね！」数の表示**
    - 他のユーザーにも「いいね数」として見えるようにする。

### 2.5. いいね数ランキング

- [ ]  **ランキングの種類**
    - [ ]  「プルリクエストそのもの」のいいね数ランキング（全期間）。
    - [ ]  「プルリクエストそのもの」のいいね数ランキング（週間）。
- [ ]  **表示件数**
    - ランキングはトップ10を表示する。

### 2.6. 新着順表示

- [ ]  **新着情報の種類**
    - ユーザーが「お気に入り登録」したライブラリに新規追加されたプルリクエストを表示する。
    - AIによる解説が「未作成」か「作成済み」かのステータスも併せて表示する。
- [ ]  **表示件数**
    - 初回表示は最新10件とし、以降はユーザーの操作（例：「もっと見る」ボタン、スクロールなど）により10件ずつ追加読み込みを行う。
- [ ]  **表示順序の考慮**
    - 「最初にお気に入り登録したライブラリ」に対する特別な表示優先度は設けない（全ライブラリを平等に扱う）。

### 2.7. 多言語対応 (将来対応)

- [ ]  **対応言語の検討**
    - [ ]  英語への対応。
- [ ]  **AIによる解説記事の言語戦略**
    - [ ]  リリース初期は、解説記事を日本語のみで生成する。
    - [ ]  将来的には、ブラウザの言語設定を検知し、解説記事の言語を自動で切り替える。
    - [ ]  ユーザーが手動で表示言語を選択・切り替えられる機能を提供する。
- [ ]  **データベース設計**
    - 1つのプルリクエストに対し、言語をキーとしたオブジェクト形式で解説データを保存し、将来的な多言語追加に対応しやすいように拡張性を持たせる。

### 2.8. Issueの内容も要約 (将来対応)

- [ ]  **機能の必要性**
    - 将来的には、GitHubのIssueの内容もAIが要約する機能を追加し、Issueとプルリクエストが連携して理解できるようにすることを目指す。
- [ ]  **AIに要約させるIssueの情報**
    - [ ]  報告されている問題点の概要。
    - [ ]  問題が関連すると思われるリポジトリ内のファイルや機能。
    - [ ]  Issueのコメント欄における議論の要点（例: 解決策の提案、原因分析など）。

