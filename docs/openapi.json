{
	"openapi": "3.0.3",
	"info": {
		"title": "PR News Backend API",
		"version": "1.0.0",
		"description": "Pull Request解説記事生成サービスのバックエンドAPI仕様書。API設計ガイドラインに基づき、Hono + Zod + Hono Client を用いたREST APIの設計方針を反映しています。\n共通レスポンスとして ApiResponse<T> を採用し、エラーコードは ErrorCode として列挙型で管理します。"
	},
	"servers": [
		{
			"url": "/"
		}
	],
	"components": {
		"securitySchemes": {
			"bearerAuth": {
				"type": "http",
				"scheme": "bearer",
				"bearerFormat": "JWT",
				"description": "Firebase IDトークンを Bearer トークンとして指定します。"
			}
		},
		"schemas": {
			"ErrorCode": {
				"type": "string",
				"description": "アプリケーション固有のエラーコードの列挙型",
				"enum": [
					"VALIDATION_ERROR",
					"UNAUTHENTICATED",
					"FORBIDDEN",
					"NOT_FOUND",
					"INTERNAL_SERVER_ERROR"
				],
				"example": "NOT_FOUND"
			},
			"ErrorObject": {
				"type": "object",
				"description": "エラーレスポンスの詳細情報",
				"properties": {
					"code": {
						"$ref": "#/components/schemas/ErrorCode"
					},
					"details": {
						"type": "object",
						"nullable": true,
						"description": "エラーの詳細情報（バリデーションエラーの場合、フィールドごとのエラー内容など）",
						"additionalProperties": true,
						"example": [
							{
								"field": "email",
								"reason": "正しいメールアドレス形式で入力してください"
							}
						]
					}
				},
				"required": ["code"]
			},
			"User": {
				"type": "object",
				"description": "ユーザー情報を表すスキーマ",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "ユーザーID (UUID形式)"
					},
					"githubUserId": {
						"type": "integer",
						"description": "GitHub ユーザーID (整数、正の数)",
						"minimum": 1
					},
					"githubUsername": {
						"type": "string",
						"description": "GitHub ユーザー名 (必須)",
						"minLength": 1
					},
					"githubDisplayName": {
						"type": "string",
						"nullable": true,
						"description": "GitHub 表示名"
					},
					"email": {
						"type": "string",
						"format": "email",
						"nullable": true,
						"description": "メールアドレス (正しいメールアドレス形式)"
					},
					"avatarUrl": {
						"type": "string",
						"format": "url",
						"nullable": true,
						"description": "アバター画像のURL (正しいURL形式)"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time",
						"description": "作成日時 (正しい日時形式)",
						"nullable": true
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time",
						"description": "更新日時 (正しい日時形式)",
						"nullable": true
					}
				},
				"required": ["id", "githubUserId", "githubUsername"]
			},
			"PullRequest": {
				"type": "object",
				"description": "Pull Requestの基本情報を表すスキーマ",
				"properties": {
					"prNumber": {
						"type": "integer",
						"description": "PR 番号 (整数、正の数)",
						"minimum": 1
					},
					"repositoryFullName": {
						"type": "string",
						"description": "リポジトリのフルネーム (例: 'owner/repo')"
					},
					"githubPrUrl": {
						"type": "string",
						"format": "url",
						"description": "GitHub上のPRのURL (正しいURL形式)"
					},
					"title": {
						"type": "string",
						"description": "PRのタイトル"
					},
					"body": {
						"type": "string",
						"nullable": true,
						"description": "PRの本文"
					},
					"diff": {
						"type": "string",
						"description": "PRの差分情報"
					},
					"authorLogin": {
						"type": "string",
						"description": "PR作成者のGitHubログイン名"
					},
					"githubPrCreatedAt": {
						"type": "string",
						"format": "date-time",
						"description": "GitHub上でのPR作成日時 (正しい日時形式)"
					}
				},
				"required": [
					"prNumber",
					"repositoryFullName",
					"githubPrUrl",
					"title",
					"diff",
					"authorLogin",
					"githubPrCreatedAt"
				]
			},
			"ChangeTypeEnum": {
				"type": "string",
				"description": "変更の種類を示す列挙型",
				"enum": [
					"FEAT",
					"FIX",
					"REFACTOR",
					"DOCS",
					"TEST",
					"PERF",
					"BUILD",
					"CHORE"
				],
				"example": "FEAT"
			},
			"CategoryEnum": {
				"type": "string",
				"description": "注目ポイントのカテゴリを示す列挙型",
				"enum": ["TECH", "RISK", "UX", "PERF", "SECURITY"],
				"example": "TECH"
			},
			"MainChange": {
				"type": "object",
				"description": "主要な変更点を示すスキーマ",
				"properties": {
					"fileName": {
						"type": "string",
						"description": "変更されたファイル名"
					},
					"changeTypes": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/ChangeTypeEnum"
						},
						"description": "変更の種類（複数選択可）",
						"minItems": 1
					},
					"description": {
						"type": "string",
						"description": "変更内容の説明"
					}
				},
				"required": ["fileName", "changeTypes", "description"]
			},
			"NotablePoint": {
				"type": "object",
				"description": "特筆すべき点を示すスキーマ",
				"properties": {
					"categories": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/CategoryEnum"
						},
						"description": "注目ポイントのカテゴリ（複数選択可）",
						"minItems": 1
					},
					"point": {
						"type": "string",
						"description": "注目ポイントの内容"
					}
				},
				"required": ["categories", "point"]
			},
			"PullRequestArticle": {
				"type": "object",
				"description": "Pull Requestの解説記事を表すスキーマ。PullRequestの基本情報を拡張しています。",
				"allOf": [
					{
						"$ref": "#/components/schemas/PullRequest"
					}
				],
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "記事ID (UUID形式)"
					},
					"aiGeneratedTitle": {
						"type": "string",
						"description": "AIによって生成された記事タイトル (必須、1～80文字)",
						"minLength": 1,
						"maxLength": 80
					},
					"backgroundAndPurpose": {
						"type": "string",
						"nullable": true,
						"description": "背景と目的"
					},
					"mainChanges": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/MainChange"
						},
						"nullable": true,
						"description": "主要な変更点のリスト"
					},
					"notablePoints": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/NotablePoint"
						},
						"nullable": true,
						"description": "特筆すべき点のリスト"
					},
					"summaryGeneratedAt": {
						"type": "string",
						"format": "date-time",
						"description": "AIによる要約が生成された日時 (正しい日時形式)"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time",
						"description": "記事の作成日時 (正しい日時形式)",
						"nullable": true
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time",
						"description": "記事の更新日時 (正しい日時形式)",
						"nullable": true
					}
				},
				"required": ["id", "aiGeneratedTitle", "summaryGeneratedAt"]
			},
			"AuthSession": {
				"type": "object",
				"description": "認証セッション情報を表すスキーマ",
				"properties": {
					"id": {
						"type": "string",
						"format": "uuid",
						"description": "セッションID (UUID形式)"
					},
					"userId": {
						"type": "string",
						"format": "uuid",
						"description": "ユーザーID (UUID形式)"
					},
					"firebaseUid": {
						"type": "string",
						"description": "Firebase UID"
					},
					"tokenHash": {
						"type": "string",
						"description": "トークンのハッシュ値 (SHA-256、64文字)",
						"minLength": 64,
						"maxLength": 64
					},
					"expiresAt": {
						"type": "string",
						"format": "date-time",
						"description": "トークンの有効期限 (正しい日時形式)"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time",
						"description": "セッション作成日時 (正しい日時形式)"
					},
					"revokedAt": {
						"type": "string",
						"format": "date-time",
						"nullable": true,
						"description": "セッション無効化日時 (正しい日時形式、任意)"
					}
				},
				"required": [
					"id",
					"userId",
					"firebaseUid",
					"tokenHash",
					"expiresAt",
					"createdAt"
				]
			},
			"HealthCheckResponseData": {
				"type": "object",
				"properties": {
					"ok": {
						"type": "boolean"
					}
				},
				"required": ["ok"]
			},
			"LogoutResponseData": {
				"type": "object",
				"description": "ログアウト成功時の空のデータオブジェクト"
			}
		}
	},
	"paths": {
		"/healthz": {
			"get": {
				"summary": "ヘルスチェック",
				"description": "サービスの稼働状況を確認します。コンテナやロードバランサのliveness/readiness probeに使用されます。",
				"tags": ["General"],
				"responses": {
					"200": {
						"description": "サービス正常稼働",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/HealthCheckResponseData"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {
										"ok": true
									}
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									},
									"message": "サーバー内部でエラーが発生しました。"
								}
							}
						}
					}
				}
			}
		},
		"/users/me": {
			"get": {
				"summary": "現在のユーザー情報を取得",
				"description": "認証されている現在のユーザーのプロファイル情報を取得します。フロントエンドのユーザーダッシュボード初期読み込みなどに使用されます。",
				"security": [
					{
						"bearerAuth": []
					}
				],
				"tags": ["User & Auth"],
				"responses": {
					"200": {
						"description": "ユーザー情報の取得成功",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/User"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {
										"id": "5f8c9c1d-df89-4294-8218-a303ef525b6c",
										"githubUsername": "octocat",
										"avatarUrl": "https://avatars.githubusercontent.com/u/583231?v=4"
									}
								}
							}
						}
					},
					"401": {
						"description": "認証エラー (トークン無効など)",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "UNAUTHENTICATED"
									},
									"message": "認証トークンが無効です。再度ログインしてください。"
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									},
									"message": "サーバー内部でエラーが発生しました。"
								}
							}
						}
					}
				}
			}
		},
		"/auth/logout": {
			"post": {
				"summary": "ログアウト処理",
				"description": "現在のユーザーセッションを無効化し、ログアウトします。サーバー側でAuthSessionのrevokedAtを更新します。",
				"security": [
					{
						"bearerAuth": []
					}
				],
				"tags": ["User & Auth"],
				"responses": {
					"200": {
						"description": "ログアウト成功",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/LogoutResponseData"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {},
									"message": "Logged out successfully"
								}
							}
						}
					},
					"401": {
						"description": "認証エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "UNAUTHENTICATED"
									},
									"message": "認証されていません。"
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									},
									"message": "サーバー内部でエラーが発生しました。"
								}
							}
						}
					}
				}
			}
		},
		"/repos/{owner}/{repo}/pulls/{number}/ingest": {
			"post": {
				"summary": "GitHubから指定されたPull Request情報を取得・保存",
				"description": "GitHub APIを利用してPull Requestのメタデータ、差分、コメントなどを取得し、データベースにPullRequestとして保存（既に存在する場合は更新）します。",
				"security": [
					{
						"bearerAuth": []
					}
				],
				"tags": ["Pull Request"],
				"parameters": [
					{
						"name": "owner",
						"in": "path",
						"required": true,
						"description": "リポジトリのオーナー名",
						"schema": {
							"type": "string"
						},
						"example": "octocat"
					},
					{
						"name": "repo",
						"in": "path",
						"required": true,
						"description": "リポジトリ名",
						"schema": {
							"type": "string"
						},
						"example": "Hello-World"
					},
					{
						"name": "number",
						"in": "path",
						"required": true,
						"description": "Pull Requestの番号",
						"schema": {
							"type": "integer"
						},
						"example": 42
					}
				],
				"responses": {
					"200": {
						"description": "Pull Request情報の取得・保存成功",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/PullRequest"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {
										"prNumber": 42,
										"repositoryFullName": "acme/widgets",
										"githubPrUrl": "https://github.com/acme/widgets/pull/42",
										"title": "feat: add new widget",
										"body": "This PR adds a new widget to the application.",
										"diff": "...",
										"authorLogin": "alice",
										"githubPrCreatedAt": "2025-06-04T12:34:56Z"
									}
								}
							}
						}
					},
					"401": {
						"description": "認証エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "UNAUTHENTICATED"
									}
								}
							}
						}
					},
					"404": {
						"description": "指定されたリソースが見つからない (例: GitHub上でPRが存在しない)",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "NOT_FOUND"
									},
									"message": "指定されたPull Requestが見つかりません。"
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									}
								}
							}
						}
					}
				}
			}
		},
		"/repos/{owner}/{repo}/pulls/{number}/article": {
			"post": {
				"summary": "指定されたPull Requestの解説記事をAIで生成・保存",
				"description": "既存のPullRequest情報を基に、Geminiを利用して差分を要約し、PullRequestArticleとして生成・保存します。PullRequestが存在しない場合は404エラーとなります。",
				"security": [
					{
						"bearerAuth": []
					}
				],
				"tags": ["Article Generation"],
				"parameters": [
					{
						"name": "owner",
						"in": "path",
						"required": true,
						"description": "リポジトリのオーナー名",
						"schema": {
							"type": "string"
						},
						"example": "octocat"
					},
					{
						"name": "repo",
						"in": "path",
						"required": true,
						"description": "リポジトリ名",
						"schema": {
							"type": "string"
						},
						"example": "Hello-World"
					},
					{
						"name": "number",
						"in": "path",
						"required": true,
						"description": "Pull Requestの番号",
						"schema": {
							"type": "integer"
						},
						"example": 42
					}
				],
				"responses": {
					"200": {
						"description": "Pull Request解説記事の生成・保存成功",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/PullRequestArticle"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {
										"id": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
										"prNumber": 42,
										"repositoryFullName": "acme/widgets",
										"githubPrUrl": "https://github.com/acme/widgets/pull/42",
										"title": "feat: add new widget",
										"authorLogin": "alice",
										"githubPrCreatedAt": "2025-06-04T12:34:56Z",
										"aiGeneratedTitle": "✨ 新しいウィジェット機能の追加",
										"summaryGeneratedAt": "2025-06-04T13:00:00Z"
									}
								}
							}
						}
					},
					"202": {
						"description": "解説記事の生成処理受付完了（非同期処理中）",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"message": {
											"type": "string",
											"nullable": false
										}
									},
									"required": ["success", "message"]
								},
								"example": {
									"success": true,
									"message": "Pull Request解説記事の生成処理を受け付けました。完了までしばらくお待ちください。"
								}
							}
						}
					},
					"401": {
						"description": "認証エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "UNAUTHENTICATED"
									}
								}
							}
						}
					},
					"404": {
						"description": "対象のPull Requestが見つからない",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "NOT_FOUND"
									},
									"message": "解説記事生成の元となるPull Requestが見つかりません。"
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー（AI生成失敗など）",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									},
									"message": "記事生成中にエラーが発生しました。"
								}
							}
						}
					}
				}
			},
			"get": {
				"summary": "生成済みのPull Request解説記事を取得",
				"description": "指定されたPull Requestに対応する、生成済みの解説記事を取得します。記事がまだ生成されていない場合は404エラーとなります。",
				"security": [
					{
						"bearerAuth": []
					}
				],
				"tags": ["Article Generation"],
				"parameters": [
					{
						"name": "owner",
						"in": "path",
						"required": true,
						"description": "リポジトリのオーナー名",
						"schema": {
							"type": "string"
						},
						"example": "octocat"
					},
					{
						"name": "repo",
						"in": "path",
						"required": true,
						"description": "リポジトリ名",
						"schema": {
							"type": "string"
						},
						"example": "Hello-World"
					},
					{
						"name": "number",
						"in": "path",
						"required": true,
						"description": "Pull Requestの番号",
						"schema": {
							"type": "integer"
						},
						"example": 42
					}
				],
				"responses": {
					"200": {
						"description": "Pull Request解説記事の取得成功",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/PullRequestArticle"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {
										"id": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
										"prNumber": 42,
										"repositoryFullName": "acme/widgets",
										"githubPrUrl": "https://github.com/acme/widgets/pull/42",
										"title": "feat: add new widget",
										"authorLogin": "alice",
										"githubPrCreatedAt": "2025-06-04T12:34:56Z",
										"aiGeneratedTitle": "✨ 新しいウィジェット機能の追加",
										"mainChanges": [
											{
												"fileName": "src/widget.ts",
												"changeTypes": ["FEAT"],
												"description": "Widgetクラスに新しいメソッドを追加"
											}
										],
										"summaryGeneratedAt": "2025-06-04T13:00:00Z"
									}
								}
							}
						}
					},
					"401": {
						"description": "認証エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "UNAUTHENTICATED"
									}
								}
							}
						}
					},
					"404": {
						"description": "解説記事がまだ生成されていない、またはPull Requestが存在しない",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "NOT_FOUND"
									},
									"message": "指定されたPull Requestの解説記事は見つかりません。"
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									}
								}
							}
						}
					}
				}
			}
		},
		"/repos/{owner}/{repo}/pulls/{number}": {
			"get": {
				"summary": "データベースにキャッシュされたPull Request本体を取得",
				"description": "GitHub APIのレート制限対策として、データベースにキャッシュされたPull Request情報を優先して返します。`refresh=true` クエリパラメータで強制的にGitHubから最新情報を取得しキャッシュを更新することも可能です。",
				"security": [
					{
						"bearerAuth": []
					}
				],
				"tags": ["Pull Request"],
				"parameters": [
					{
						"name": "owner",
						"in": "path",
						"required": true,
						"description": "リポジトリのオーナー名",
						"schema": {
							"type": "string"
						},
						"example": "octocat"
					},
					{
						"name": "repo",
						"in": "path",
						"required": true,
						"description": "リポジトリ名",
						"schema": {
							"type": "string"
						},
						"example": "Hello-World"
					},
					{
						"name": "number",
						"in": "path",
						"required": true,
						"description": "Pull Requestの番号",
						"schema": {
							"type": "integer"
						},
						"example": 42
					},
					{
						"name": "refresh",
						"in": "query",
						"required": false,
						"description": "trueの場合、キャッシュを無視してGitHubから最新情報を強制的に取得・更新します。",
						"schema": {
							"type": "boolean"
						},
						"example": false
					}
				],
				"responses": {
					"200": {
						"description": "Pull Request情報の取得成功",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": true
										},
										"data": {
											"$ref": "#/components/schemas/PullRequest"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "data"]
								},
								"example": {
									"success": true,
									"data": {
										"prNumber": 42,
										"repositoryFullName": "acme/widgets",
										"githubPrUrl": "https://github.com/acme/widgets/pull/42",
										"title": "feat: add new widget",
										"authorLogin": "alice",
										"githubPrCreatedAt": "2025-06-04T12:34:56Z"
									}
								}
							}
						}
					},
					"401": {
						"description": "認証エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "UNAUTHENTICATED"
									}
								}
							}
						}
					},
					"404": {
						"description": "Pull Requestが見つからない",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "NOT_FOUND"
									},
									"message": "指定されたPull Requestは見つかりません。"
								}
							}
						}
					},
					"500": {
						"description": "サーバー内部エラー",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean",
											"example": false
										},
										"error": {
											"$ref": "#/components/schemas/ErrorObject"
										},
										"message": {
											"type": "string",
											"nullable": true
										}
									},
									"required": ["success", "error"]
								},
								"example": {
									"success": false,
									"error": {
										"code": "INTERNAL_SERVER_ERROR"
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"tags": [
		{
			"name": "General",
			"description": "一般的なAPI（ヘルスチェックなど）"
		},
		{
			"name": "User & Auth",
			"description": "ユーザー情報および認証関連のAPI"
		},
		{
			"name": "Pull Request",
			"description": "Pull Request情報の取得・管理API"
		},
		{
			"name": "Article Generation",
			"description": "Pull Request解説記事の生成・取得API"
		}
	]
}
